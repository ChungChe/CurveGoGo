<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title> Title: {{ title }} </title>
	</head>
	<body>
		<h1> {{ user.nickname }} ! </h1>
		<form id="form1" method="post" action="/draw_chart">
					Start: 
					<input id="date_timepicker_start" name="datetime_start" type="text" value="2016-04-18 16:42:53" maxlength="15" size="15" class="inputs">
					End:
					<input id="date_timepicker_end" name="datetime_end" type="text" value="2016-04-18 16:54:02" maxlength="15" size="15" class="inputs">
				<button type="button" id="press_go">GO</button>
			<p>
			機器ID:
			<button type="button" class="select_all_button" onclick="select(true)">全選</button>
			<button type="button" class="diselect_all_button" onclick="select(false)">全不選</button>
			<p>
			{% for row_id in range(0, 5) -%}
				{% for col_id in range(0, 5) -%}
					{{ zfill(row_id * 5 +  col_id + 1, 2) }}<input type="checkbox" id="check_machine_{{ row_id * 5 + col_id + 1 }}" checked=true>
				{% endfor %}
				<p>
			{% endfor %}

		<div id="algorithmChart" style="height: 400px;"></div>
		<div id="result"></div>
		</form>
	</body>
		<script src="static/js/jquery.js"></script>
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
		<script src="//cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script> 
		<script src="static/js/jquery.datetimepicker.full.min.js"></script>
		<script src="static/js/gogo.js"></script>
		<link rel="stylesheet" href="static/css/jquery.datetimepicker.css">
		<link rel="stylesheet" href="static/css/textinput.css">
	{% block scripts %}
	<script>
		
		$('#press_go').click(function() {
		    var machine_list = get_machine_list();	
			
			$.ajax({
				type: 'POST',
				contentType: 'application/json',
				data: JSON.stringify({
					"datetime_start" : $('#date_timepicker_start').val(),
					"datetime_end" : $('#date_timepicker_end').val(),
					"mlist" : machine_list
					}),
					dataType: 'json',
					url: '/draw_chart',
					success: function(chartData) {
						$("#algorithmChart").empty();
						machines = []
						labels = []
						machine_list.forEach(function(m_id) {
							machines.push("M" + m_id);
							labels.push("M" + m_id);
						});
						var morrisChart = Morris.Line({
							element: 'algorithmChart',
							data: chartData['data'],
							xkey: 'datetime',
							parseTime: true,
							ykeys: machines,
							labels: labels,
							lineWidth: 1,
							smooth: true,
							goals: [120],
							goalStrokeWidth: 5
						});
					},
					error: function(error) {
						console.log('error');
						console.log(eval(error));
					}
			});
		});

	</script>
	{% endblock %}
</html>
